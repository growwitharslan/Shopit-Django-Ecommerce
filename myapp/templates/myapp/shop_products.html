{% extends 'myapp/base.html' %}
{% load static %}
{% block content %}

<!--====== Breadcrumbs Part Start ======-->
<section class="breadcrumbs-wrapper pt-50 pb-50 bg-primary-4">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumbs-style breadcrumbs-style-1 d-md-flex justify-content-between align-items-center">
                    <div class="breadcrumb-left">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page">
                                Shop
                            </li>
                        </ol>
                    </div>

                </div>
            </div>
        </div>
    </div>
</section>
<!--====== Breadcrumbs Part Ends ======-->


<section class="product-wrapper pt-100 pb-100">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="mb-50">
                    <h1 class="heading-1 font-weight-700">All Products</h1>
                </div>
            </div>
        </div>
        <div class="row">
            {% for product in page_obj %}
            <div class="col-lg-6">
                <div class="product-style-7 mt-30">
                    <div class="product-image">
                        <div class="product-active">
                            <div class="product-item active">
                                <img src="{{ product.image.url }}" alt="product" style="width:100%; height:250px; object-fit:cover; border-radius:8px;" />
                            </div>
                            <div class="product-item">
                                <img src="{{ product.image2.url }}" alt="product" style="width:100%; height:250px; object-fit:cover; border-radius:8px;" />
                            </div>
                        </div>
                    </div>
                    <div class="product-content">
                        <ul class="product-meta">
                            <li class="badge bg-light text-dark rounded">
                                {{ product.category.name }}
                            </li>
                        </ul>
                        <h4 class="title">
                            <a href="{% url 'product_detail' product.id %}">{{ product.name }}</a>
                        </h4>
                        <p>{{ product.description|slice:":15" }}</p>
                        <span class="price">$ {{ product.price }}</span>
                        <div class="product-quantity d-inline-flex">
                            <a href="#" class="main-btn primary-btn cart-btn" data-id="{{ product.id }}">
                                <img src="{% static 'images/icon-svg/cart-4.svg' %}" alt="" />
                                Add to Cart
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
            <div class="row mt-4">
                
                <div class="col-12">
                  <nav aria-label="Page navigation">
                    <ul class="pagination justify-content-center">
                      {% if page_obj.has_previous %}
                        <li class="page-item">
                          <a class="page-link" href="?page={{ page_obj.previous_page_number }}" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                          </a>
                        </li>
                      {% else %}
                        <li class="page-item disabled"><span class="page-link">&laquo;</span></li>
                      {% endif %}
              
                      {% for num in page_obj.paginator.page_range %}
                        {% if page_obj.number == num %}
                          <li class="page-item active"><span class="page-link">{{ num }}</span></li>
                        {% elif num > page_obj.number|add:-3 and num < page_obj.number|add:3 %}
                          <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
                        {% endif %}
                      {% endfor %}
              
                      {% if page_obj.has_next %}
                        <li class="page-item">
                          <a class="page-link" href="?page={{ page_obj.next_page_number }}" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                          </a>
                        </li>
                      {% else %}
                        <li class="page-item disabled"><span class="page-link">&raquo;</span></li>
                      {% endif %}
                    </ul>
                  </nav>
                </div>
              </div>
        </div>
    </div>
</section>

<!--====== Clients Logo Part Start ======-->
<section class="clients-logo-section pt-70 pb-70">
    <div class="container">
        <div class="row client-logo-active">
            <div class="col-lg-3">
                <div class="single-logo-wrapper">
                    <img src="{% static 'images/client-logo/uideck-logo.svg' %}" alt="" />
                </div>
            </div>
            <div class="col-lg-3">
                <div class="single-logo-wrapper">
                    <img src="{% static 'images/client-logo/graygrids-logo.svg' %}" alt="" />
                </div>
            </div>
            <div class="col-lg-3">
                <div class="single-logo-wrapper">
                    <img src="{% static 'images/client-logo/lineicons-logo.svg' %}" alt="" />
                </div>
            </div>
            <div class="col-lg-3">
                <div class="single-logo-wrapper">
                    <img src="{% static 'images/client-logo/pagebulb-logo.svg' %}" alt="" />
                </div>
            </div>
        </div>
    </div>
</section>
<!--====== Clients Logo Part Ends ======-->



{% endblock %}

{% block scripts %}

<script>
    $(document).ready(function () {


        toastr.options = {
            "closeButton": true,
            "progressBar": true,
            "positionClass": "toast-bottom-left",
            "timeOut": "3000"
        };
        $('.cart-btn').click(function () {
            const productId = $(this).data('id');
            const quantity = 1;

            $.ajax({
                url: "{% url 'add_to_cart' %}",
                type: "POST",
                data: {
                    'product_id': productId,
                    'quantity': quantity,
                    'csrfmiddlewaretoken': '{{ csrf_token }}'
                },
                success: function (response) {
                    // Update cart count UI if you have one
                    $('#cart-count').text(response.cart_count);

                    // Show Toastr success notification
                    toastr.success('Product added to cart!');
                }
            });
        });
    }); 

</script>

{% endblock %}